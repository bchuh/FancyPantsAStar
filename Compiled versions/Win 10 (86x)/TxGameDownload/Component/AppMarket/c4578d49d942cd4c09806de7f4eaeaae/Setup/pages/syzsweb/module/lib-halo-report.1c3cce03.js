(window.webpackJsonpsyzs=window.webpackJsonpsyzs||[]).push([["lib-halo-report"],{V66g:function(t,e,r){"use strict";r.r(e),r.d(e,"BuiltInEvents",(function(){return F})),r.d(e,"CONTEXT",(function(){return x})),r.d(e,"ClickObserver",(function(){return $})),r.d(e,"ElementObserver",(function(){return H})),r.d(e,"Observer",(function(){return W})),r.d(e,"PageViewObserver",(function(){return X})),r.d(e,"ReportAction",(function(){return O})),r.d(e,"Reporter",(function(){return Q})),r.d(e,"TrackingNode",(function(){return z})),r.d(e,"ViewObserver",(function(){return G})),r.d(e,"util",(function(){return A}));r("Wr5T");var n=r("jO/C"),i=r.n(n),o=r("NkL+"),u=r.n(o),c=r("hNk0"),a=r.n(c),s=r("T8vI"),f=r.n(s),l=r("4JtV"),h=f.a,p="object"===typeof window&&window.WeakSet||a.a;function v(t,e){return void 0===e&&(e={}),u()(t)?t:e}function d(t,e){return typeof t===e?t:void 0}function y(t,e){for(var r=0;r<t.length;r++)if(e(t[r],r,t))return t[r];return null}function m(t,e){for(var r=[],n=0;n<t.length;n++)r=r.concat(e(t[n],n,t));return r}function g(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var n=0,i=e;n<i.length;n+=1){var o=i[n];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(t[u]=o[u])}return t}function b(t){for(var e=[],r=0,n=e.length=t.length;r<n;r++)e[r]=t[r];return e}function k(t,e){if(void 0===e&&(e=document),/^(#?[\w-]+|\.[\w-.]+)$/.test(t)){var r=t.charAt(0);if("#"===r&&e===document){var n=document.getElementById(t.substr(1));return n?[n]:[]}if("."===r){var i=t.substr(1).replace(/\./g," ");return b(e.getElementsByClassName(i))}return b(e.getElementsByTagName(t))}return b(e.querySelectorAll(t))}function w(t){return"tag"===t.type?0:"attribute"===t.type?"id"===t.name&&"equals"===t.action?1:"class"===t.name&&"element"===t.action?2:3:"pseudo"===t.type?4:5}function E(t,e){return w(t)-w(e)}var O,A=Object.freeze({__proto__:null,getValue:i.a,mergeOptions:h,isPlainObject:u.a,noop:function(){},find:y,includes:function(t,e){return t.indexOf(e)>=0},flatMap:m,assign:g,stripUndefined:function(t){return Object.keys(t).reduce((function(e,r){return void 0!==t[r]&&(e[r]=t[r]),e}),{})},arrayLikeToArray:b,querySelectorAll:k});function _(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Array.isArray(t)?t.map((function(t){return t.apply(void 0,e)})):t?[t.apply(void 0,e)]:[]}function j(t,e){return t&&!Array.isArray(t)?j([t],e):Array.isArray(t)?t.reduce((function(t,e){var r=e(t);return void 0===r?t:r}),e):e}function N(t){return"function"===typeof t?(e=t,function(t){return N(e(t))(t)}):u()(t)?(r=t,function(){return r}):"string"===typeof t?function(t){var e=t.split("."),r=e[e.length-1];return function(t){var n;return(n={})[r]=i()(t,e),n}}(t):Array.isArray(t)?function(t){var e=t[0],r=t[1];return function(t){return e.split(".").reduceRight((function(t,e){var r;return(r={})[e]=t,r}),i()(t,r))}}(t):function(){return{}};var e,r}function T(t){return Array.isArray(t)?t.map(N):[N(t)]}function V(t){var e=d(t.selector,"string");if(e&&e.indexOf(",")>=0)return m(e.split(",").map((function(t){return t.trim()})),(function(e){return V(g({},t,{selector:e}))}));var r={selector:e,event:d(t.event,"string"),matches:d(t.matches,"function"),searchAncestor:!0===t.searchAncestor,data:T(t.data||[]),action:d(t.action,"number")||0};return r.lastSelectorItem=function(t){if(t){var e=t.split(/[ >+~]/).filter(Boolean).map((function(t){return t.trim()}));return e[e.length-1]}}(r.selector),[r]}function S(t){var e,r=(e=t.rules,Array.isArray(e)?m(e.filter(u.a),V).filter((function(t){return t.event||t.selector||t.matches})):[]),n=u()(t.data);if(t.data&&!n){var i=V({data:T(t.data||[])});r.push(i[0])}return{rules:r,hooks:v(t.hooks),data:n?t.data:{}}}function R(t,e){return(null==e.event||e.event===t.event)&&(null==e.selector||t.target instanceof Element&&t.target.matches(e.selector))&&(null==e.matches||function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return Array.isArray(t)?t.every((function(t){return t.apply(void 0,e)})):!!t&&!!t.apply(void 0,e)}(e.matches,t))}!function(t){t[t.Block=-1]="Block",t[t.Default=0]="Default",t[t.Report=1]="Report",t[t.Track=2]="Track"}(O||(O={}));var x="__rctx__";function B(t){return g({},t,{target:t.target.parentElement})}function C(t){t.rules=function(t){return t.reporter.rules.filter((function(e){return R(t,e)}))}(t);var e=function(t){return y(t.rules,(function(t){return 1===t.action||-1===t.action}))}(t);if(t.action=e?e.action:0,!(t.target instanceof Element))return t;if(e&&1===e.action){if(e.searchAncestor){var r=C(B(t));if(r.target)return r}return t}return C(B(t))}function I(t){return 1!==t.action?null:t}function L(t){var e=v(null!=t&&t[x]);return(t instanceof HTMLElement?function(t){var e=g({},t.dataset);return(t.parentElement?L(t.parentElement):[]).concat([e])}(t):[]).concat([e])}function P(t){var e=t.target&&"object"===typeof t.target?L(t.target):[],r=function(t){for(var e=[],r=0,n=t.rules;r<n.length;r+=1){e=n[r].data.map((function(e){return e(t)})).reverse().concat(e)}return e.filter(u.a)}(t),n=[v(window[x]),t.reporter.data].concat(e,r,[t.data]);return t.data=h.apply({ignoreUndefined:!0},n),t}function M(t){return t.map((function(t){return function(e){return null===e?null:t(e)}}))}function q(t,e,r,n){void 0===n&&(n={});var i={reporter:t,event:e,target:r,rules:[],action:0,data:v(n)},o=M([j.bind(null,M(t.hooks.event)),C,I,P,j.bind(null,M(t.hooks.context))]);return j(o,i)}var z=function(t,e,r){void 0===r&&(r=null),this.children=[],this.selectors={},this.reporter=t,this.el=e,this.parent=r,e.trackingNode=this};function J(t){for(var e=t;e;){if(e.trackingNode)return e.trackingNode;e=e.parentElement}}function D(t){t.isNewElement=!0}function K(t){t.isNewElement||(t.removeAttribute("tracking"),t.trackingNode=void 0)}function U(t){var e=function(t){for(var e={},r=0,n=t;r<n.length;r+=1){var i=n[r];i.selector&&0!==i.action&&(e[i.selector]||(e[i.selector]=i))}return t.filter((function(t){return e[t.selector]&&-1!==t.action}))}(t.reporter.rules),r=t.reporter;if(e.length){var n=k("[tracking]",t.el),i=k(e.map((function(t){return t.selector})).join(","),t.el),o=m(e,(function(e){return k(e.selector,t.el).map((function(t){return[t,e]}))}));t.children=[],i.forEach(D),n.forEach(K),n.forEach(function(t){return function(e){e.isNewElement||t.view.unobserve(e)}}(r)),i.forEach(function(t){return function(e){e.isNewElement=void 0,e.hasAttribute("tracking")||e.setAttribute("tracking","");var r=J(e.parentElement),n=new z(t.reporter,e,r);r.children.push(n)}}(t)),o.forEach(function(t){return function(e){var r=e[1];t.selectors[r.lastSelectorItem]=r}}(t)),o.forEach(function(t){return function(e){var r=e[0],n=e[1];n.event&&"view"!==n.event||t.view.observe(r)}}(r))}}z.prototype.getKeySelector=function(){var t;return this.keySelector||(this.keySelector=(t=Object.keys(this.selectors),m(Object.keys(t),(function(t){return Object(l.parse)(t)})).reduce((function(t,e){return t.concat(e)})).sort(E).map((function(t){return Object(l.stringify)([[t]])})).filter((function(t,e,r){return!y(r.slice(0,e),(function(e){return t===e}))})).join(""))),this.keySelector},z.prototype.getIndex=function(){var t=this;return this.parent?this.parent.children.filter((function(e){return Object.keys(t.selectors).every((function(t){return!!e.selectors[t]}))})).indexOf(this):0},z.prototype.getPath=function(){if(!this.parent)return"";var t=this.parent.getPath(),e=this.getKeySelector()+":nth-key-child("+(this.getIndex()+1)+")";return t?t+" "+e:e};var W=function(t,e){this.reporter=t,this.options=e};W.prototype.destroy=function(){};var F,H=function(t){function e(e){t.call(this,e),this.mo=new MutationObserver(this.onMutation.bind(this)),this.mo.observe(document,{attributes:!0,childList:!0,subtree:!0})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onMutation=function(t){var e=new p;t.filter((function(t){return t.target instanceof Element&&"tracking"!==t.attributeName})).map((function(t){return J(t.target.parentElement)})).filter(Boolean).forEach((function(t){e.has(t)||(U(t),e.add(t))}))},e}(W),X=function(t){function e(e,r){t.call(this,e,r),this.emit=this.reporter.emit.bind(null,"pv",document,void 0),this.init()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(){var t,e=this;(null===(t=this.options)||void 0===t?void 0:t.manuallyEmit)||(performance.timing.loadEventEnd?this.timeout=setTimeout((function(){return e.emit()})):window.addEventListener("load",this.emit))},e.prototype.destroy=function(){window.removeEventListener("load",this.emit),this.timeout&&clearTimeout(this.timeout)},e}(W),$=function(t){function e(e){var r=this;t.call(this,e),this.emit=function(t){r.reporter.emit("click",t.target,{event:t})},this.init()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(){document.addEventListener("click",this.emit,!0)},e.prototype.destroy=function(){document.removeEventListener("click",this.emit,!0)},e}(W),G=function(t){function e(e){var r=this;t.call(this,e),this.emit=function(t){for(var e=0,n=t;e<n.length;e+=1){var i=n[e];i.intersectionRatio<.5||(r.hasViewed.has(i.target)||(r.io.unobserve(i.target),r.hasViewed.add(i.target),r.reporter.emit("view",i.target,{event:i})))}},this.init()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.init=function(){this.io=new IntersectionObserver(this.emit,{threshold:.5}),this.hasViewed=new p},e.prototype.observe=function(t){this.io.observe(t)},e.prototype.reobserve=function(t){this.hasViewed.delete(t),this.observe(t)},e.prototype.unobserve=function(t){this.io.unobserve(t)},e.prototype.destroy=function(){this.hasViewed=void 0,this.io.disconnect()},e}(W);!function(t){t.PageView="pv",t.Click="click",t.View="view"}(F||(F={}));var Q=function(t){var e;this.rules=[],this.data={},this.observers=[],this.started=!1,this.emit=this.emit.bind(this),this.hooks={init:[],event:[],context:[],report:[]},!0!==(null===(e=t)||void 0===e?void 0:e.manuallyStart)&&this.startCollecting(t),this.config(t)};Q.prototype.startCollecting=function(t){var e;if(!this.started){this.started=!0,this.use(H),this.use(X,{manuallyEmit:null===(e=t)||void 0===e?void 0:e.manuallyEmitPv}),this.use($),this.use(G);var r=this.observers,n=r[0],i=r[1],o=r[2],u=r[3];Object.assign(this,{elementObserver:n,pv:i,click:o,view:u}),this.trackingRoot=new z(this,document.firstElementChild),U(this.trackingRoot)}},Q.prototype.config=function(t){if(t){var e=S(t);this.data=h(this.data,e.data),this.rules=e.rules.concat(this.rules);for(var r=0,n=Object.keys(this.hooks);r<n.length;r+=1){var i=n[r],o=e.hooks[i];o&&this.hooks[i].push(o)}e.hooks.init&&e.hooks.init(this),this.trackingRoot&&U(this.trackingRoot)}},Q.prototype.emit=function(t,e,r){var n=arguments.length;if(0!==n){if(1===n)return this.emit.bind(this,t);if(2===n)return this.emit.bind(this,t,e);try{var i=q(this,t,e,r);if(!i)return;_(this.hooks.report,i)}catch(t){}}},Q.prototype.use=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];if(this.observers.some((function(e){return e instanceof t})))throw new Error("Observer "+t.name+" is already exist");this.observers.push(new(Function.prototype.bind.apply(t,[null].concat([this],e))))},Q.prototype.eject=function(t){var e=this.observers.map((function(t,e){return[t,e]})).filter((function(e){return e[0]instanceof t}))[0],r=e[0],n=e[1];r.destroy(),this.observers.splice(n,1)},Q.prototype.ejectAll=function(){this.observers.forEach((function(t){return t.destroy()})),this.observers=[]}}}]);